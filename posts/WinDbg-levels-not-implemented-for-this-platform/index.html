<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="WinDbg Preview - a dirty fix for “Levels not implemented for this platform”" /><meta property="og:locale" content="en" /><meta name="description" content="The issue" /><meta property="og:description" content="The issue" /><link rel="canonical" href="https://grx78fl.github.io/posts/WinDbg-levels-not-implemented-for-this-platform/" /><meta property="og:url" content="https://grx78fl.github.io/posts/WinDbg-levels-not-implemented-for-this-platform/" /><meta property="og:site_name" content="GRX’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-19T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="WinDbg Preview - a dirty fix for “Levels not implemented for this platform”" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-20T00:56:37-05:00","datePublished":"2023-02-19T00:00:00-05:00","description":"The issue","headline":"WinDbg Preview - a dirty fix for “Levels not implemented for this platform”","mainEntityOfPage":{"@type":"WebPage","@id":"https://grx78fl.github.io/posts/WinDbg-levels-not-implemented-for-this-platform/"},"url":"https://grx78fl.github.io/posts/WinDbg-levels-not-implemented-for-this-platform/"}</script><title>WinDbg Preview - a dirty fix for "Levels not implemented for this platform" | GRX's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="GRX's Blog"><meta name="application-name" content="GRX's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/20095224" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">GRX's Blog</a></div><div class="site-subtitle font-italic">Yet another InfoSec Blog.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/GRX78FL" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>WinDbg Preview - a dirty fix for "Levels not implemented for this platform"</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>WinDbg Preview - a dirty fix for "Levels not implemented for this platform"</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1676782800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 19, 2023 </em> </span> <span> Updated <em class="" data-ts="1676872597" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 20, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/GRX78FL">GRX78FL</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="587 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h2 id="the-issue"><span class="mr-2"><strong>The issue</strong></span><a href="#the-issue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Imagine being deep into a kernel debugging session and suddenly your debugger stops working as expected.</p><p><img data-src="https://user-images.githubusercontent.com/20095224/219982466-9d03c9f1-4218-4b15-883b-43d70a3ff7a8.png" alt="(Levels not implemented for this platform)" data-proofer-ignore></p><p>(<a href="https://learn.microsoft.com/en-us/answers/questions/1010386/windbg-pte-command-levels-not-implemented-for-this">This</a> has been <a href="https://github.com/MicrosoftDocs/windows-driver-docs/issues/3058">going on</a> for <a href="https://github.com/MicrosoftDocs/windows-driver-docs/issues/2587"><strong>years</strong></a> at this point and it doesn’t look like there’s active interest in fixing or investigating the bug, yet.)</p><p>Still, it continues to be a crippling bug that affects us at the worst possible times.</p><p>Rebooting to roll the dice in hopes this will temporarily fix the issue might be out of the question since debugging without symbols is already quite involved, and scrapping progress in for convenience’s sake feels like a massive waste of time, so let’s try to figure out what causes this to happen by looking at the symptoms.</p><h2 id="kdextsdll"><span class="mr-2"><strong>KdExts.dll</strong></span><a href="#kdextsdll" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Extensions! <code class="language-plaintext highlighter-rouge">!pte</code> is what’s called an extension in WinDbg terms, that is, it’s not <em>core</em> functionality since it only applies to kernel debugging sessions. It is therefore implemented in the Kernel Debugger Extensions DLL (KdExts.dll) found in the install directory of WinDbg - which is likely somewhere in <code class="language-plaintext highlighter-rouge">C:\Program Files\WindowsApps</code>, for my particular version it is found at<br /> <code class="language-plaintext highlighter-rouge">C:\Program Files\WindowsApps\Microsoft.WinDbg_1.2210.3001.0_x64__8wekyb3d8bbwe\amd64\winxp\kdexts.dll</code></p><p>I’ll save you the trouble of finding where exactly the “Levels not implemented for this platform” message is referenced (you can do this an exercise if you’d like), and show you what the code responsible looks like once decompliled:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>  <span class="p">...</span>
  <span class="k">switch</span> <span class="p">(</span> <span class="n">g_TargetMachine</span> <span class="p">)</span>                     <span class="c1">// debuggee machine's arch</span>
  <span class="p">{</span>
    <span class="k">case</span> <span class="n">IMAGE_FILE_MACHINE_I386</span><span class="p">:</span>
      <span class="k">goto</span> <span class="n">I386</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">IMAGE_FILE_MACHINE_ARM</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">IMAGE_FILE_MACHINE_THUMB</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">IMAGE_FILE_MACHINE_ARMNT</span><span class="p">:</span>
      <span class="n">v10</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="nl">I386:</span>
      <span class="n">v9</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">PaeEnabled</span> <span class="p">)</span>
        <span class="n">v10</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">IMAGE_FILE_MACHINE_AMD64</span><span class="p">:</span>             <span class="c1">// we're obviously debugging an x64 machine</span>
      <span class="n">v9</span> <span class="o">=</span> <span class="n">DbgPagingLevels</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">DbgPagingLevels</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="p">)</span> <span class="c1">// Paging levels above 5 aren't implemented yet</span>
      <span class="p">{</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s">"Levels not implemented for this platform</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">FAIL</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">...</span>
  <span class="nl">FAIL:</span>
      <span class="n">ExtensionApis</span><span class="p">.</span><span class="n">lpOutputRoutine</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">...</span>
</pre></table></code></div></div><p>If you’re not familiar with paging, this <a href="https://wiki.osdev.org/Paging">odsev article</a> has some insight into why our bug is so absurd.</p><h2 id="windbg-inception"><span class="mr-2"><strong>WinDbg-Inception</strong></span><a href="#windbg-inception" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here comes the dirty fix part.</p><p>We have :</p><ul><li>symbols for kdexts.dll;<li>a debugger (yes, we’ll use WinDbg to patch WinDbg);<li>a good sense of humor</ul><p><img data-src="https://user-images.githubusercontent.com/20095224/219986156-6be94a4d-ee18-4122-928c-1311d1ded8b6.jpg" alt="thanos" data-proofer-ignore></p><h2 id="the-fix"><span class="mr-2"><strong>The fix</strong></span><a href="#the-fix" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h4 id="steps"><span class="mr-2"><strong>Steps:</strong></span><a href="#steps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>open a second instance of WinDbg and attach to the faulty instance;<li>issue the <code class="language-plaintext highlighter-rouge">.reload /f</code> command to force symbol loading;<li>locate the g_TargetMachine global variable and confirm it’s still IMAGE_FILE_MACHINE_AMD64 (0x8664)</ul><p><img data-src="https://user-images.githubusercontent.com/20095224/219986361-74ff7230-a066-447b-89e9-fd0622fa085f.png" alt="image" data-proofer-ignore></p><ul><li>great, let’s look at DbgPagingLevels</ul><p><img data-src="https://user-images.githubusercontent.com/20095224/219986536-c0026428-22e5-4be0-9203-2f9c804dca8f.png" alt="image" data-proofer-ignore></p><p>That makes no sense.</p><p>Let’s edit the memory to reflect the correct value (which as of Feb 2023 <a href="https://en.wikipedia.org/wiki/Intel_5-level_paging">should be</a> either 4 or 5 depending on your CPU/Windows Edition combo). I’ll edit it to 4, because of my CPU is quite an old one and I’m not using Windows Server edition. (This is bound to be way more variable in the future, but by then, hopefully you won’t need this guide anymore).</p><p><img data-src="https://user-images.githubusercontent.com/20095224/219987026-cd2776ae-ad73-43f4-aaa7-f94a2a08f1d8.png" alt="image" data-proofer-ignore></p><ul><li>hit <code class="language-plaintext highlighter-rouge">g</code> or <code class="language-plaintext highlighter-rouge">Go</code> button and make sure your Kd debugger instance is stable<li>detach from from it and close the second WinDbg instance<li>now try <code class="language-plaintext highlighter-rouge">!pte</code> again</ul><p><img data-src="https://user-images.githubusercontent.com/20095224/219987236-2d9593e0-bf81-4c6b-a58e-516b16ebf127.png" alt="image" data-proofer-ignore></p><p>And that’s it, you can keep on hunting bugs.</p><p>I hope this was useful.</p><hr /><h3 id="note"><span class="mr-2"><strong>Note:</strong></span><a href="#note" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is not a proper fix, and this article skips the root cause analysis of this behavior. It is intended to be a quick way of dealing with the issue when it presents itself.</p><p>Additional analysis may or may not be posted here as an update, but for now I’m only interested in continuing the work I was interrupted from.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windbg/'>WINDBG</a>, <a href='/categories/assembly/'>ASSEMBLY</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/windbg/" class="post-tag no-text-decoration" >windbg</a> <a href="/tags/x86-64/" class="post-tag no-text-decoration" >x86-64</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=WinDbg+Preview+-+a+dirty+fix+for+%22Levels+not+implemented+for+this+platform%22+-+GRX%27s+Blog&url=https%3A%2F%2Fgrx78fl.github.io%2Fposts%2FWinDbg-levels-not-implemented-for-this-platform%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=WinDbg+Preview+-+a+dirty+fix+for+%22Levels+not+implemented+for+this+platform%22+-+GRX%27s+Blog&u=https%3A%2F%2Fgrx78fl.github.io%2Fposts%2FWinDbg-levels-not-implemented-for-this-platform%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fgrx78fl.github.io%2Fposts%2FWinDbg-levels-not-implemented-for-this-platform%2F&text=WinDbg+Preview+-+a+dirty+fix+for+%22Levels+not+implemented+for+this+platform%22+-+GRX%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fgrx78fl.github.io%2Fposts%2FWinDbg-levels-not-implemented-for-this-platform%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/WinDbg-levels-not-implemented-for-this-platform/">WinDbg Preview - a dirty fix for "Levels not implemented for this platform"</a><li><a href="/posts/Dynamic-Loader-x86-64-MASM-0x01/">Writing A (covert) Dynamic Loader in x86-64 MASM [0x01]</a><li><a href="/posts/Dynamic-Loader-x86-64-MASM-0x00/">Writing A (covert) Dynamic Loader in x86-64 MASM [0x00]</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/x86-64/">x86-64</a> <a class="post-tag" href="/tags/masm/">masm</a> <a class="post-tag" href="/tags/windbg/">windbg</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Dynamic-Loader-x86-64-MASM-0x00/"><div class="card-body"> <em class="small" data-ts="1656388800" data-df="ll" > Jun 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing A (covert) Dynamic Loader in x86-64 MASM [0x00]</h3><div class="text-muted small"><p> [0x00] - Introduction Assumptions about the reader’s knowledge: Understanding of C code (pointers, structs, control flow …); Some Python3 experience (basic operations); Some Assem...</p></div></div></a></div><div class="card"> <a href="/posts/Dynamic-Loader-x86-64-MASM-0x01/"><div class="card-body"> <em class="small" data-ts="1656388800" data-df="ll" > Jun 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing A (covert) Dynamic Loader in x86-64 MASM [0x01]</h3><div class="text-muted small"><p> [0x01] - General Code Structure What we’re doing: How we’re doing it: We’ll start by declaring the only two imports we require to bootstrap our loader. ; HMODULE GetModul...</p></div></div></a></div><div class="card"> <a href="/posts/Dynamic-Loader-x86-64-MASM-0x02/"><div class="card-body"> <em class="small" data-ts="1656648000" data-df="ll" > Jul 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing A (covert) Dynamic Loader in x86-64 MASM [0x02]</h3><div class="text-muted small"><p> [0x02] - The Problem Imports: As the analysts we’d like to quickly get an idea of what this binary is doing statically. So we sit down, open our favorite tool and check what kind of file...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Dynamic-Loader-x86-64-MASM-0x02/" class="btn btn-outline-primary" prompt="Older"><p>Writing A (covert) Dynamic Loader in x86-64 MASM [0x02]</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/GRX78FL">GRX78FL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/x86-64/">x86-64</a> <a class="post-tag" href="/tags/masm/">masm</a> <a class="post-tag" href="/tags/windbg/">windbg</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
